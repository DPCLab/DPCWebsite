function formatPercent(t){return(100*t).toFixed(2)+"%"}var pieCharts=d3.selectAll(".pie").each(function(){var t,e,a=this.dataset.responses.split(","),l=["Visible","Potentially Censored"],s=["#ffffff","#6c5ce7"],n=this.dataset.name,r=0,o=a.map(function(t,e){return r+=parseInt(t),{label:l[e],value:parseInt(t),color:s[e]}}),d=d3.pie().value(function(t){return t.value}).sort(null),i=d3.arc().outerRadius(80).innerRadius(40),c=d3.select(this).select(".tooltip"),p=this;d3.select(this).style("width",160);d3.select(this).append("svg").attr("width",160).attr("height",160).append("g").attr("transform","translate(80,80)").selectAll("path").data(d(o)).enter().append("path").attr("fill",function(t,e){return t.data.color}).attr("stroke","white").attr("d",i).on("mouseover",function(e,a){t="<h3>"+e.data.label+"</h3><p>"+e.value+" posts ("+formatPercent(e.value/r)+")</p>",c.classed("hidden",!1).html(t)}).on("mousemove",function(t){e=d3.mouse(p),c.style("left",e[0]-Math.round(c.node().offsetWidth/2)+"px").style("top",e[1]-Math.round(c.node().offsetHeight)-12+"px"),d3.select(this).style("fill",d3.rgb(d3.color(t.data.color).brighter(.5)))}).on("mouseout",function(t){c.classed("hidden",!0),d3.select(this).style("fill",t.color)});var h=d3.select(this).append("div").attr("class","pie-label").style("width","160px");n&&h.append("h3").html(n),h.selectAll("span").data(o).enter().append("span").html(function(t,e){return"<div class = 'bubble' style = 'background:"+t.color+"'></div>"+t.label}).append("br")});